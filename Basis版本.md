# SWTC项目升级计划-Basis版本

## 目录
<!-- TOC -->

- [SWTC项目升级计划-Basis版本](#swtc项目升级计划-basis版本)
  - [目录](#目录)
  - [Basis版本](#basis版本)
    - [后台架构](#后台架构)
      - [项目框架](#项目框架)
      - [项目分层](#项目分层)
        - [数据库](#数据库)
        - [数据库操作层（注：也可整合到处理层中）](#数据库操作层注也可整合到处理层中)
        - [处理层](#处理层)
        - [接口层](#接口层)
      - [解决方案](#解决方案)
        - [项目安全](#项目安全)
        - [SWTC LIB 连接操作](#swtc-lib-连接操作)
        - [后台权限](#后台权限)
        - [定时任务](#定时任务)
        - [数据备份](#数据备份)
        - [服务器日志](#服务器日志)
        - [数据表内结构更换](#数据表内结构更换)
        - [项目部署和监控](#项目部署和监控)
        - [报表统计](#报表统计)
        - [操作日志](#操作日志)

<!-- /TOC -->


## Basis版本

### 后台架构

#### 项目框架

- [Eggjs](https://eggjs.org/zh-cn/) 阿里云NodeJS服务架构体系
- [宝塔Linux](https://m.bt.cn/download/linux.html) 可以监控的Linux服务器面板

#### 项目分层

##### 数据库

- Mysql 关系型存储结构，适用于通用业务
- Redis 持久化session,做登录验证和权限处理

##### 数据库操作层（注：也可整合到处理层中）

- 使用ORM框架进行封装，对Mysql数据库进行基础操作
- 复杂操作和其他业务不同的逻辑可以在代码里面直接使用 SQL语句
- Redis 数据处理在业务层处理，做好规范的认证体系

##### 处理层

- SWTC LIB web socket 链接处理函数
- 基础的业务逻辑处理函数
- 复杂整合的业务处理函数，为接口层做支撑

##### 接口层

- API call 调用处理层进行处理
- 基础接口必须采用 RESTful 接口规范
- 业务接口非必要采用 RESTful 接口规范

#### 解决方案

##### 项目安全

1. 使用 session + cookie 认证方式进行认证（老版本-可选）
2. 密码，钱包地址，私钥在传输时进行加密，密码在数据库内部进行加密
3. 接口通用权限验证

##### SWTC LIB 连接操作

1. 使用处理层进行 SWTC LIB 库对接操作，保证及时更新和返回的数据结构一致

##### 后台权限

1. 一种超级管理员
2. 管理接口做权限控制

##### 定时任务

1. 使用EggJs框架内部程序做定时任务

##### 数据备份

1. 使用宝塔Liunx 服务器管理面板定期备份Mysql库到阿里OSS文件存储系统

##### 服务器日志

1. 使用EggJs内部日志系统存储在系统本地

##### 数据表内结构更换

1. 系统内部建立数据库结构维护文件，更新表结构先更新文件，同步到git，在git上可以找到结构的更换说明

##### 项目部署和监控

1. 使用EggJS 内部命令进行部署和down机重启（首选，需要调研）

##### 报表统计

1. 用apiCall的形式进行报备统计，可适用实时统计。

##### 操作日志

1. 数据记录与MySQL中，系统后台封装统计操作日志处理函数